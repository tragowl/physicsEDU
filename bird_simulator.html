<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í¬ë¬¼ì„  ìš´ë™ ì¶©ëŒ ì‹œë®¬ë ˆì´í„°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Jua&family=Pretendard:wght@400;700&display=swap');
        body { background-color: #f0f9ff; font-family: 'Pretendard', sans-serif; }
        h1 { font-family: 'Jua', sans-serif; }
        canvas { 
            background: linear-gradient(to bottom, #87CEEB 0%, #E0F2FE 100%); 
            border: 4px solid #ffffff; 
            border-radius: 16px; 
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
            width: 100%; 
            height: auto; 
        }
        .control-panel { background: white; padding: 1.5rem; border-radius: 16px; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); }
        .info-box { background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(4px); border-radius: 12px; border: 2px solid #3b82f6; padding: 1rem; margin-bottom: 1rem; }
        input[type=range] { width: 100%; cursor: pointer; }
    </style>
</head>
<body class="p-4 md:p-8">
    <div class="max-w-6xl mx-auto">
        <h1 class="text-4xl font-bold mb-2 text-center text-blue-600 drop-shadow-sm">í¬ë¬¼ì„  ëŒ€ê²©ëŒ! ì‹œë®¬ë ˆì´ì…˜</h1>
        
        <!-- ì €ì‘ê¶Œ ë° ì œì‘ì ì •ë³´ -->
        <div class="text-center mb-6 text-gray-500 text-xs sm:text-sm">
            <p>Â© 2026. <span class="font-bold text-gray-700">ê¹€í˜„ì„</span> All rights reserved.</p>
            <p>ì—°ë½ì²˜: <a href="mailto:tragowl@onedu.jje.go.kr" class="hover:text-blue-500 underline">tragowl@onedu.jje.go.kr</a></p>
            <p class="mt-1 font-medium text-red-400">â€» ë³¸ ì‹œë®¬ë ˆì´í„°ëŠ” êµìœ¡ìš© ëª©ì ìœ¼ë¡œ ì œì‘ë˜ì—ˆìœ¼ë©°, ì˜ë¦¬ ëª©ì ì˜ ë¬´ë‹¨ ì‚¬ìš©ì„ ê¸ˆí•©ë‹ˆë‹¤.</p>
        </div>

        <!-- ìƒë‹¨ ì •ë³´ì°½ -->
        <div id="infoDisplay" class="info-box flex flex-wrap justify-between items-center gap-4">
            <div class="flex items-center space-x-4">
                <div>
                    <span class="font-semibold text-blue-800">ìµœì†Œ ì ‘ê·¼ ê±°ë¦¬: </span>
                    <span id="minDistText" class="text-2xl font-bold text-blue-600">---</span> <span class="text-blue-800 font-bold">m</span>
                </div>
                <div class="h-8 w-px bg-blue-200 mx-2"></div>
                <div>
                    <span class="font-semibold text-gray-600">ì„¤ì •ëœ ì¶©ëŒ ë°˜ê²½: </span>
                    <span id="thresholdVal" class="text-xl font-bold text-orange-600">1.0</span> <span class="text-orange-600 font-bold">m</span>
                </div>
            </div>
            <div id="collisionStatus" class="hidden animate-bounce">
                <span class="bg-red-500 text-white px-4 py-2 rounded-full font-bold shadow-lg text-lg">ğŸ’¥ ì¶©ëŒ ì„±ê³µ! ğŸ’¥</span>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-4 gap-6">
            <!-- ì„¤ì • íŒ¨ë„ -->
            <div class="lg:col-span-1 control-panel space-y-5">
                <div>
                    <label class="block text-sm font-bold text-gray-700 mb-1">ğŸš€ ì´ˆê¸° ì†ë ¥ (m/s)</label>
                    <input type="number" id="v0" value="50" class="w-full border-2 border-blue-100 rounded-lg p-2 focus:border-blue-500 outline-none" step="1">
                </div>
                <div class="grid grid-cols-2 gap-2">
                    <div>
                        <label class="block text-sm font-bold text-red-600 mb-1">ğŸ“ 1í˜¸ ê°ë„(Â°)</label>
                        <input type="number" id="theta1" value="80" class="w-full border-2 border-red-100 rounded-lg p-2 outline-none focus:border-red-500 text-sm" step="1">
                    </div>
                    <div>
                        <label class="block text-sm font-bold text-blue-600 mb-1">ğŸ“ 2í˜¸ ê°ë„(Â°)</label>
                        <input type="number" id="theta2" value="30" class="w-full border-2 border-blue-100 rounded-lg p-2 outline-none focus:border-blue-500 text-sm" step="1">
                    </div>
                </div>
                <div>
                    <label class="block text-sm font-bold text-gray-700 mb-1">â±ï¸ ë°œì‚¬ ì§€ì—° (ì´ˆ)</label>
                    <input type="number" id="delay" value="7.36" class="w-full border-2 border-blue-100 rounded-lg p-2 outline-none focus:border-blue-500" step="0.01">
                </div>
                <div>
                    <label class="block text-sm font-bold text-purple-600 mb-1">ğŸŒ ì¤‘ë ¥ ê°€ì†ë„ (m/sÂ²)</label>
                    <input type="number" id="gravity" value="10" class="w-full border-2 border-purple-100 rounded-lg p-2 outline-none focus:border-purple-500" step="0.1">
                </div>
                <div class="pt-2">
                    <label class="block text-sm font-bold text-orange-600 mb-1">ğŸ¯ ì¶©ëŒ ê°ì§€ ë°˜ê²½ (m)</label>
                    <input type="range" id="collisionThreshold" min="0.1" max="5.0" step="0.1" value="1.0" class="accent-orange-500">
                    <div class="flex justify-between text-[10px] text-gray-400 font-bold"><span>0.1m</span><span>2.5m</span><span>5.0m</span></div>
                </div>
                <button id="runBtn" class="w-full bg-blue-500 hover:bg-blue-600 text-white text-xl font-bold py-4 rounded-xl shadow-md transform transition active:scale-95">
                    ë°œì‚¬í•˜ê¸°!
                </button>
            </div>

            <!-- ìº”ë²„ìŠ¤ ì˜ì—­ -->
            <div class="lg:col-span-3 relative">
                <canvas id="simCanvas"></canvas>
                <div class="mt-4 p-4 bg-green-50 border-2 border-green-100 rounded-xl text-sm text-green-800 shadow-sm">
                    <strong>ğŸ® ì•ˆë‚´:</strong> ìŠ¬ë¼ì´ë”ë¥¼ í†µí•´ ì¶©ëŒ ì˜ˆë¯¼ë„ë¥¼ ì¡°ì ˆí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìˆ˜í‰ì¶•ê³¼ ìˆ˜ì§ì¶•ì˜ ëˆˆê¸ˆì€ ì‹¤ì œ ë¯¸í„°(m) ë‹¨ìœ„ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. ì¤‘ë ¥ ê°€ì†ë„ë¥¼ ì¡°ì ˆí•˜ì—¬ ë‹¤ë¥¸ í–‰ì„±ì—ì„œì˜ ìš´ë™ë„ ì‹¤í—˜í•´ë³´ì„¸ìš”!
                </div>
            </div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('simCanvas');
        const ctx = canvas.getContext('2d');
        const runBtn = document.getElementById('runBtn');
        const minDistText = document.getElementById('minDistText');
        const collisionStatus = document.getElementById('collisionStatus');
        const thresholdSlider = document.getElementById('collisionThreshold');
        const thresholdValDisplay = document.getElementById('thresholdVal');

        // í™˜ê²½ ë³€ìˆ˜
        let g = 10;
        const dt = 0.02;
        const scale = 2.8; 
        const margin = 60;

        let animationId = null;
        let minDistance = Infinity;
        let hasCollided = false;
        let collisionThreshold = 1.0; 
        let collisionPoint = null; 

        // ìŠ¬ë¼ì´ë” ì´ë²¤íŠ¸
        thresholdSlider.oninput = function() {
            collisionThreshold = parseFloat(this.value);
            thresholdValDisplay.innerText = collisionThreshold.toFixed(1);
        };

        function initCanvas() {
            canvas.width = 900;
            canvas.height = 500;
            drawStaticBackground();
        }

        function toRad(deg) { return deg * (Math.PI / 180); }

        function drawStaticBackground() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // í•˜ëŠ˜ ê·¸ë¼ë°ì´ì…˜
            let sky = ctx.createLinearGradient(0, 0, 0, canvas.height);
            sky.addColorStop(0, '#87CEEB');
            sky.addColorStop(1, '#E0F2FE');
            ctx.fillStyle = sky;
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // êµ¬ë¦„
            ctx.fillStyle = "rgba(255, 255, 255, 0.8)";
            drawCloud(150, 80, 40);
            drawCloud(500, 120, 30);
            drawCloud(750, 60, 45);

            // ì§€ë©´
            ctx.fillStyle = "#4ade80";
            ctx.fillRect(0, canvas.height - margin, canvas.width, margin);
            ctx.fillStyle = "#22c55e";
            ctx.fillRect(0, canvas.height - margin, canvas.width, 5);

            // ë‚˜ë¬´ë“¤
            drawTree(100, canvas.height - margin);
            drawTree(700, canvas.height - margin);
            drawTree(820, canvas.height - margin);

            drawAxes();
        }

        function drawCloud(x, y, size) {
            ctx.beginPath();
            ctx.arc(x, y, size, 0, Math.PI * 2);
            ctx.arc(x + size * 0.6, y - size * 0.2, size * 0.8, 0, Math.PI * 2);
            ctx.arc(x + size * 1.2, y, size * 0.7, 0, Math.PI * 2);
            ctx.fill();
        }

        function drawTree(x, y) {
            ctx.fillStyle = "#713f12"; 
            ctx.fillRect(x - 5, y - 20, 10, 20);
            ctx.fillStyle = "#166534"; 
            ctx.beginPath();
            ctx.moveTo(x - 20, y - 20);
            ctx.lineTo(x + 20, y - 20);
            ctx.lineTo(x, y - 50);
            ctx.fill();
        }

        function drawAxes() {
            ctx.strokeStyle = "#1f2937";
            ctx.lineWidth = 3;
            ctx.fillStyle = "#1f2937";
            ctx.font = "bold 12px Arial";

            ctx.beginPath();
            ctx.moveTo(margin, canvas.height - margin);
            ctx.lineTo(canvas.width - 20, canvas.height - margin);
            ctx.stroke();

            ctx.beginPath();
            ctx.moveTo(margin, 20);
            ctx.lineTo(margin, canvas.height - margin);
            ctx.stroke();

            ctx.textAlign = "center";
            for (let m = 0; m <= 300; m += 50) {
                const xPos = margin + m * scale;
                if (xPos > canvas.width - 20) break;
                ctx.lineWidth = 1;
                ctx.strokeStyle = "rgba(0,0,0,0.1)";
                ctx.beginPath(); ctx.moveTo(xPos, 20); ctx.lineTo(xPos, canvas.height - margin); ctx.stroke();
                ctx.lineWidth = 2;
                ctx.strokeStyle = "#1f2937";
                ctx.beginPath(); ctx.moveTo(xPos, canvas.height - margin); ctx.lineTo(xPos, canvas.height - margin + 8); ctx.stroke();
                ctx.fillText(m + "m", xPos, canvas.height - margin + 22);
            }

            ctx.textAlign = "right";
            for (let m = 0; m <= 150; m += 25) {
                const yPos = canvas.height - margin - m * scale;
                if (yPos < 20) break;
                ctx.lineWidth = 1;
                ctx.strokeStyle = "rgba(0,0,0,0.1)";
                ctx.beginPath(); ctx.moveTo(margin, yPos); ctx.lineTo(canvas.width - 20, yPos); ctx.stroke();
                ctx.lineWidth = 2;
                ctx.strokeStyle = "#1f2937";
                ctx.beginPath(); ctx.moveTo(margin, yPos); ctx.lineTo(margin - 8, yPos); ctx.stroke();
                ctx.fillText(m + "m", margin - 12, yPos + 4);
            }
        }

        function drawProjectile(x, y, color, label) {
            const px = margin + x * scale;
            const py = canvas.height - margin - y * scale;
            ctx.beginPath();
            ctx.arc(px, py, 7, 0, Math.PI * 2);
            ctx.fillStyle = color;
            ctx.shadowBlur = 10;
            ctx.shadowColor = color;
            ctx.fill();
            ctx.shadowBlur = 0;
            ctx.strokeStyle = "white";
            ctx.lineWidth = 2;
            ctx.stroke();
            ctx.fillStyle = "white";
            ctx.font = "bold 10px Arial";
            ctx.textAlign = "center";
            ctx.fillText(label, px, py + 4);
        }

        function drawStarIcon(x, y) {
            const cx = margin + x * scale;
            const cy = canvas.height - margin - y * scale;
            const spikes = 5;
            const outerRadius = 20;
            const innerRadius = 10;
            let rot = Math.PI / 2 * 3;
            let step = Math.PI / spikes;

            ctx.beginPath();
            ctx.moveTo(cx, cy - outerRadius);
            for (let i = 0; i < spikes; i++) {
                ctx.lineTo(cx + Math.cos(rot) * outerRadius, cy + Math.sin(rot) * outerRadius);
                rot += step;
                ctx.lineTo(cx + Math.cos(rot) * innerRadius, cy + Math.sin(rot) * innerRadius);
                rot += step;
            }
            ctx.lineTo(cx, cy - outerRadius);
            ctx.closePath();
            ctx.fillStyle = "#fbbf24";
            ctx.fill();
            ctx.strokeStyle = "#b45309";
            ctx.lineWidth = 3;
            ctx.stroke();
            
            // ì¢Œí‘œ í‘œì‹œ
            ctx.fillStyle = "#1e40af";
            ctx.font = "bold 14px Pretendard";
            ctx.textAlign = "left";
            ctx.shadowBlur = 4;
            ctx.shadowColor = "white";
            ctx.fillText(`(${x.toFixed(1)}, ${y.toFixed(1)})`, cx + 25, cy + 5);
            ctx.shadowBlur = 0;
        }

        function startSimulation() {
            if (animationId) cancelAnimationFrame(animationId);

            const v0 = parseFloat(document.getElementById('v0').value);
            const theta1 = toRad(parseFloat(document.getElementById('theta1').value));
            const theta2 = toRad(parseFloat(document.getElementById('theta2').value));
            const delay = parseFloat(document.getElementById('delay').value);
            g = parseFloat(document.getElementById('gravity').value); 

            let t = 0;
            const traj1 = [];
            const traj2 = [];
            minDistance = Infinity;
            hasCollided = false;
            collisionPoint = null; 
            collisionStatus.classList.add('hidden');

            function animate() {
                drawStaticBackground();

                let x1 = v0 * Math.cos(theta1) * t;
                let y1 = v0 * Math.sin(theta1) * t - 0.5 * g * Math.pow(t, 2);
                if (y1 < 0) y1 = -100;

                let x2 = 0, y2 = -100;
                if (t >= delay) {
                    let t2 = t - delay;
                    x2 = v0 * Math.cos(theta2) * t2;
                    y2 = v0 * Math.sin(theta2) * t2 - 0.5 * g * Math.pow(t2, 2);
                    if (y2 < 0) y2 = -100;
                }

                if (y1 >= 0) traj1.push({x: x1, y: y1});
                if (y2 >= 0) traj2.push({x: x2, y: y2});

                // ê¶¤ì 
                ctx.setLineDash([4, 4]);
                ctx.lineWidth = 2;
                if (traj1.length > 1) {
                    ctx.strokeStyle = "#ef4444";
                    ctx.beginPath();
                    traj1.forEach((p, i) => i === 0 ? ctx.moveTo(margin + p.x * scale, canvas.height - margin - p.y * scale) : ctx.lineTo(margin + p.x * scale, canvas.height - margin - p.y * scale));
                    ctx.stroke();
                }
                if (traj2.length > 1) {
                    ctx.strokeStyle = "#3b82f6";
                    ctx.beginPath();
                    traj2.forEach((p, i) => i === 0 ? ctx.moveTo(margin + p.x * scale, canvas.height - margin - p.y * scale) : ctx.lineTo(margin + p.x * scale, canvas.height - margin - p.y * scale));
                    ctx.stroke();
                }
                ctx.setLineDash([]);

                // ë¬¼ì²´
                if (y1 >= 0) drawProjectile(x1, y1, '#ef4444', '1');
                if (y2 >= 0) drawProjectile(x2, y2, '#3b82f6', '2');

                // ê±°ë¦¬ ê³„ì‚°
                if (y1 >= 0 && y2 >= 0) {
                    const dist = Math.sqrt(Math.pow(x1 - x2, 2) + Math.pow(y1 - y2, 2));
                    if (dist < minDistance) {
                        minDistance = dist;
                        minDistText.innerText = minDistance.toFixed(3);
                    }
                    if (!hasCollided && dist <= collisionThreshold) {
                        hasCollided = true;
                        collisionPoint = { x: (x1 + x2) / 2, y: (y1 + y2) / 2 };
                        collisionStatus.classList.remove('hidden');
                    }
                }

                // ì¶©ëŒ ì•„ì´ì½˜ ë° ì¢Œí‘œ ê³ ì • í‘œì‹œ
                if (hasCollided && collisionPoint) {
                    drawStarIcon(collisionPoint.x, collisionPoint.y);
                }

                t += dt;

                if (t > 40 || (y1 < 0 && y2 < 0 && t > delay + 1)) {
                    cancelAnimationFrame(animationId);
                    return;
                }
                animationId = requestAnimationFrame(animate);
            }
            animate();
        }

        window.onload = initCanvas;
        runBtn.addEventListener('click', startSimulation);
    </script>
</body>
</html>